import{d as w,Y as y,r as b,a3 as C,o as I,R as i,b as E,c as P,y as x,w as R,e as t,a4 as B,a5 as r,a6 as D,a7 as M,a8 as S,V as k,a9 as H,F as d,aa as N,ab as U,H as F,ac as T,I as V,ad as L,C as $,ae as A,af as W,ag as Y,ah as q,ai as z}from"./index-CohFQF8p.js";const _=w(()=>{const c=y(),g=()=>({text:"",title:"",order:0,slug:"",subtitle:"",allowComment:!0,id:void 0,images:[],meta:void 0}),p=e=>A(a)(e),a=b(g()),l=C(()=>c.query.id);I(async()=>{const e=l.value;if(e&&typeof e=="string"){const o=(await i.api.pages(e).get({})).data;p(o)}});const n=E(!1),u=P(),m=x(),v=async()=>{const e=()=>{try{if(!a.title||a.title.trim().length==0)throw"标题为空";if(!a.slug)throw"路径为空";return{...z(a),title:a.title.trim(),slug:a.slug.trim()}}catch(s){throw u.error(s),s}};if(l.value){if(!W(l.value))return;const s=l.value;await i.api.pages(s).put({data:e()}),u.success("修改成功")}else await i.api.pages.post({data:e()}),u.success("发布成功");m.push({name:Y.ListPage,hash:"|publish"})};return R(()=>a,()=>{window.dispatchEvent(new CustomEvent(q.EditDataUpdate))},{deep:!0}),()=>t($,{headerClass:"pt-1",actionsElement:t(d,null,[t(N,{data:a,onHandleYamlParsedMeta:e=>{const{title:s,slug:o,subtitle:h,...f}=e;a.title=s??a.title,a.slug=o??a.slug,a.subtitle=h??a.subtitle,a.meta={...f}}},null),t(U,{getData:()=>({...a})},null),t(F,{icon:t(T,null,null),onClick:v},null)]),footerButtonElement:t(d,null,[t("button",{onClick:()=>{n.value=!0}},[t(V,null,{default:()=>[t(L,null,null)]})])])},{default:()=>[t(B,{class:"relative z-10 mt-3",label:"与你有个好心情~",value:a.title,onChange:e=>{a.title=e}},null),t("div",{class:"pt-3 text-gray-700 dark:text-gray-300"},[t(r,{value:a.subtitle,onChange:e=>void(a.subtitle=e)},null)]),t("div",{class:"py-3 text-gray-500"},[t("label",null,[`${D}/`]),t(r,{value:a.slug,onChange:e=>void(a.slug=e)},null)]),t(M,{key:a.id,loading:!!(l.value&&typeof a.id>"u"),onChange:e=>{a.text=e},text:a.text},null),t(S,{disabledItem:["date-picker"],onUpdateShow:e=>{n.value=e},data:a,show:n.value},{default:()=>[t(k,{label:"页面顺序"},{default:()=>[t(H,{placeholder:"",value:a.order,onUpdateValue:e=>void(a.order=e??0)},null)]})]})]})});export{_ as default};
